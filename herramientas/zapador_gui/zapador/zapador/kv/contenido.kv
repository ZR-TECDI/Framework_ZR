#:kivy 1.11.1
#:import Generador zapador.clases.Generador
#:import cond zapador.metodos.widget_condicional
#:import cons zapador.constantes
#: import Factory kivy.factory.Factory

<Nueva@GridLayout>:
    cols:1
    listamapa:listamapa
    Contenido:
        CampoTexto:
            Etiqueta:
                text:'Autor: '
            EntradaTexto:
                id:nombre_autor
                text:'ZR Army - Dept. Tecnico y Diseño'
        CampoTexto:
            Etiqueta:
                text:'Misión: '
            EntradaTexto:
                id:nombre_mision
                text:'TEMPLATE ZR'
        CampoTexto:
            Etiqueta:
                text:'Desc: '
            EntradaTexto:
                id:desc_mision
                text:'Uso exclusivo de Zona Roja Army.'
        GridLayout:
            rows:1
            Label:
                size_hint_x:0.1
                text:'Mapa: '
                halign:'right'
                valign:'middle'
            ListaDrop:
                id:listamapa
                text:'Altis'
                values:cons.LISTA_MAPAS.keys()
                on_text: if self.text == 'Otro': Factory.MapaCustom().open()
        GridLayout:
            rows:1
            Label:
                size_hint_x:0.1
                text:'¿Misión oficial?'
                halign:'right'
                valign:'middle'
            Switch:
                size_hint_x:0.2
                id:mision_oficial
                # on_value: root.oficial = True
        GridLayout:
            rows:1
            Label:
                size_hint_x:0.1
                text:'Tipo: '
                halign:'right'
                valign:'middle'
            ListaDrop:
                id:tipomision
                text:'Improvisada'
                values:cons.TIPO_MISION.keys()
                on_text:cond(self.text, campana_lista, 'Campaña')
        GridLayout:
            cols:2
            ListaDrop:
                id:campana_lista
                text:'Elegir campaña'
                values:cons.API_JSON_TEST['CAMPANAS']
                disabled: True
                on_text:cond(self.text, campana_input, 'Crear Nueva')
            TextInput:
                id:campana_input
                text:'Nueva campaña'
                disabled: True
                valign:'middle'
                halign:'center'
        Button:
            opacity:0
            disabled:True
        AnchorLayout:
            anchor_x:'center'
            anchor_y:'center'
            Button:
                size_hint:.8,.2
                # size:100,40
                text:'Cambiar foto de carga'
                on_release:Factory.FotoMision().abrir_popup(fotomision)              
        AsyncImage:
            id:fotomision
            source:'zapador/assets/img/loadscreen.jpg'
    Button:
        text:'¡Generar!'
        size_hint_y:0.2
        on_release: Generador(nombre_autor.text, nombre_mision.text, desc_mision.text, listamapa.text, mision_oficial.active, tipomision.text, campana_lista.text, campana_input.text, fotomision.source)